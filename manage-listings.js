"use strict";(()=>{var f=null;window.addEventListener("DOMContentLoaded",async()=>{var n,r;let t=await window.$memberstackDom.getCurrentMember();t?(f=t.data.id,f&&g(f)):console.log("msId not found"),(n=document.querySelector('[concypt-btn="rconfirm"]'))==null||n.addEventListener("click",i=>{var s;i.preventDefault();let e=(s=i.target)==null?void 0:s.getAttribute("item-id");e&&v(e)}),(r=document.querySelector('[concypt-btn="cancel"]'))==null||r.addEventListener("click",i=>{i.preventDefault();let e=document.querySelector('[concypt-modal="confirm"]');e&&(e.classList.add("hide"),e.removeAttribute("item-id"))})});var g=async o=>{let t="https://tlfapi.concypt.co.uk/member-items",n=JSON.stringify({customField:"member-id",filterValue:o}),r=document.getElementById("loading-container");r&&(r.style.display="flex");try{let i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:n});if(i.ok){console.log("Response ok");let e=await i.json();if(e.data.length>0){let s=document.querySelector('[concypt-div="wrapper"]'),d=document.querySelector('[concypt-div="item"]');s&&d&&(d.classList.remove("hide"),s.innerHTML="",e.data.forEach(c=>{let l=d.cloneNode(!0),y=l.querySelector('[concypt-field="title"]'),u=l.querySelector('[concypt-field="status"]'),a=l.querySelector('[concypt-btn="view"]'),m=l.querySelector('[concypt-btn="remove"]');l.setAttribute("item-id",c.id),y?y.innerHTML=c.name:console.error('Element with concypt-field="title" not found in template'),u?u.innerHTML=c.isDraft?"Pending":"Published":console.error('Element with concypt-field="status" not found in template'),a&&!c.isDraft?(a.setAttribute("href","/listing/"+c.slug),a.setAttribute("target","_blank")):c.isDraft?(console.log("Item is a draft"),a==null||a.remove()):console.error('Button with concypt-btn="view" not found in template'),m?(m.setAttribute("item-id",c.id),m.addEventListener("click",function(p){p.preventDefault(),b(c.id)})):console.error('Button with concypt-btn="remove" not found in template'),s.appendChild(l)}))}}else{let e=document.getElementById("property-name");e&&(e.innerHTML="An error occurred. Please go back and try again.")}}catch{let e=document.getElementById("property-name");e&&(e.innerHTML="An error occurred. Please go back and try again.")}finally{r&&(r.style.display="none")}},b=o=>{var n;let t=document.querySelector('[concypt-modal="confirm"]');t&&(t.classList.remove("hide"),(n=t.querySelector('[concypt-btn="rconfirm"]'))==null||n.setAttribute("item-id",o))},h=()=>{let o=document.querySelector('[concypt-modal="confirm"]');o&&(o.classList.add("hide"),o.removeAttribute("item-id"))},v=async o=>{h();let t=document.getElementById("loading-container");t&&(t.style.display="flex");try{let n=await fetch("https://tlfapi.concypt.co.uk/remove-item",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemId:o})});n.ok?(document.querySelectorAll('[concypt-div="item"]').forEach(r=>{r.getAttribute("item-id")===o?r.remove():console.log("Item not found")}),console.log("Item removed successfully")):console.error("Error removing item:",n.statusText)}catch(n){console.error("Error:",n)}finally{t&&(t.style.display="none")}};})();
