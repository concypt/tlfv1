"use strict";(()=>{var M=window.$memberstackDom,g=window.location.href.split("/").pop(),H=g==null?void 0:g.split("?")[0];M.getCurrentMember().then(({data:t})=>{t||x()});var x=()=>{let t=!0,e=document.referrer.split("/").pop();(e==null?void 0:e.split("?")[0])==="fdiautvtn"&&(t=!1);let i=new URLSearchParams(window.location.search),n=Object.fromEntries(i.entries());if(n){let r=document.querySelector('[data-element="contact-agent-name"]');if(!r)return;r.textContent=n.name;let s=document.querySelector('[data-element="contact-agent-phone"]');if(!s)return;s.textContent=n.phone,s.closest("a").href="tel:"+n.phone;let o=document.querySelector('[data-element="contact-agent-email"]');if(!o)return;o.textContent=n.email,o.closest("a").href="mailto:"+n.email;let d=document.querySelector('[data-element="contact-agent-agency"]');if(!d)return;d.textContent=n.agency;let m=document.querySelector('[data-element="m-contact-agent-name"]');if(!m)return;m.textContent=n.name;let l=document.querySelector('[data-element="m-contact-agent-phone"]');if(!l)return;l.textContent=n.phone,l.closest("a").href="tel:"+n.phone;let u=document.querySelector('[data-element="m-contact-agent-email"]');if(!u)return;u.textContent=n.email,u.closest("a").href="mailto:"+n.email;let p=document.querySelector('[data-element="m-contact-agent-agency"]');if(!p)return;p.textContent=n.agency}t&&(window.location.href="/login")};$(()=>{var e,a,i;M.getCurrentMember().then(({data:n})=>{if(n){let r=new Date;r=String(r.getDate()).padStart(2,"0")+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+r.getFullYear();let s=n.customFields["first-name"]+" "+n.customFields["last-name"],o=n.customFields.mobile,d=n.auth.email,m=n.customFields["agency-name"],l="?name="+s+"&phone="+o+"&email="+d+"&agency="+m+"&listing="+H+"&created="+r,u="https://"+window.location.hostname+"/fdiautvtn"+encodeURI(l),p=document.querySelector("#input-url");p&&(p.value=u);let y=document.querySelector("#btn-copy-url");y==null||y.addEventListener("click",function(f){f.preventDefault(),E(u)});let c=document.querySelector('[data-element="btn-fake-share-url"]');c==null||c.addEventListener("click",function(f){f.preventDefault(),E(u)})}});let t=(e=document.querySelector('[data-element="btn-schedule-viewing"]'))==null?void 0:e.getAttribute("href");if(t==="https://www.thelistingsfactory.co.nz/schedule-viewing"){let n=(a=document.querySelector('[data-element="address"]'))==null?void 0:a.textContent,r=t+"?address="+n;(i=document.querySelector('[data-element="btn-schedule-viewing"]'))==null||i.setAttribute("href",r)}});function k(t){let e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")}catch(a){console.error("Fallback: Oops, unable to copy",a)}document.body.removeChild(e),w('[data-element="wait-notification"]','[data-element="copied-notification"]')}function E(t){if(!navigator.clipboard){k(t);return}navigator.clipboard.writeText(t).then(function(){w('[data-element="wait-notification"]','[data-element="copied-notification"]')},function(e){console.log(e)})}function w(t,e){let a=document.querySelector(t),i=document.querySelector(e);a&&(a.style.display="block"),setTimeout(()=>{a&&(a.style.display="none"),i&&(i.style.display="block"),setTimeout(()=>{i&&(i.style.display="none")},1e3)},600)}var A=document.querySelector("[at-pat]").getAttribute("at-pat");async function U(t,e){let a;t=T(t)||"",e?(e=T(e)||"",a="https://api.airtable.com/v0/appWNf6XfqAR6n0oT/"+encodeURIComponent(t)+"&view="+encodeURIComponent(e).replace(/%20/g,"+")):a="https://api.airtable.com/v0/appWNf6XfqAR6n0oT/"+encodeURIComponent(t);let i="pat1mHssDXaHifjv3.1984f7106b314f172a545d45ee7a8c59d2654b1d4b94329c4f75447d4e576e55",n={Authorization:`Bearer ${A}`};return await(await fetch(a,{headers:n})).json()}var b;tableName?U(tableName,tableViewName).then(t=>P(t)):((b=document.querySelector('[data-element="sl-table-wrapper"]'))==null||b.remove(),document.querySelector('[data-element="sl-title"]').textContent="Stocklist not found");var P=t=>{var y;if(t.error){(y=document.querySelector('[data-element="sl-table-wrapper"]'))==null||y.remove(),document.querySelector('[data-element="sl-title"]').textContent="Stocklist not found";return}let e=t.records;e.forEach(c=>{/^\d+$/.test(c.fields["Unit/Lot"])&&(c.fields["Unit/Lot"]=parseInt(c.fields["Unit/Lot"])),c.fields.Price&&(c.fields.Price="$"+N(c.fields.Price))});let a=e[0].fields,i=Object.keys(a),r=["Unit/Lot","Price","Beds","Baths","Car Park","Internal"].filter(c=>i.indexOf(c)>-1),s=i.filter(c=>r.indexOf(c)===-1);s.push(s.splice(s.indexOf("Status"),1)[0]),s.forEach(c=>{c!=="Discount"&&r.push(c)});let o=document.querySelector('[data-element="table-row"]'),d=o==null?void 0:o.firstChild;o!=null&&o.innerHTML&&(o.innerHTML="");let m="grid-template-columns: ";r.forEach(c=>{let f=d==null?void 0:d.cloneNode(!0);f.textContent=c,f.setAttribute("data-sortelement",c),o==null||o.append(f),m=m+"1fr "}),document.querySelectorAll(".s-table-row-inner").forEach(c=>{c.setAttribute("style",m)});let l=document.querySelector('[data-element="stocklist-row"]');if(!l)return;let u=l==null?void 0:l.parentElement;if(!u)return;h(e,l,u,"Unit/Lot","asc",r),document.querySelectorAll(".s-table-head-item").forEach(c=>{c.addEventListener("click",f=>{var L,S,v;f.preventDefault(),c.classList.contains("selected")||((L=document.querySelector(".selected"))==null||L.classList.remove("asc"),(S=document.querySelector(".selected"))==null||S.classList.remove("desc"),(v=document.querySelector(".selected"))==null||v.classList.remove("selected")),c.classList.contains("desc")&&!c.classList.contains("first")?(h(e,l,u,c.dataset.sortelement,"asc",r),c.classList.add("selected","asc"),c.classList.remove("desc")):(h(e,l,u,c.dataset.sortelement,"desc",r),c.classList.contains("first")||(c.classList.add("selected","desc"),c.classList.remove("asc")))})})},h=(t,e,a,i,n,r)=>{a.innerHTML="";let s=!1,o=I(t,i,n);for(let d in o)if(o.hasOwnProperty(d)){let m=o[d].fields,l=R(e,m,r);if(!l)return;s&&l.classList.add("colored"),s=!s,a.append(l)}},R=(t,e,a)=>{let i=t.cloneNode(!0),n=i.querySelector(".s-table-cell-item"),r=n==null?void 0:n.parentElement;if(r&&n)return r.innerHTML="",i.innerHTML="",a.forEach(s=>{let o=n.cloneNode(!0);o.setAttribute("data-element",s),o.textContent=e[s],(s==="Internal"||s==="External"||s==="Land Size"||s==="Land"||s==="Lot Size")&&(o.innerHTML=Math.floor(e[s])+"m <sup>2</sup>"),s==="Status"&&(e[s]==="Sold"?o.classList.add("status-red"):e[s]==="Under Contract"?o.classList.add("status-orange"):e[s]==="Available"&&o.classList.add("status-green")),r.append(o)}),i.append(r),i},I=(t,e,a)=>{if(e==="Default")return t;let i=typeof t[0].fields[e];if(!i)return;let n=t.slice(0);if(i==="number")n.sort(function(r,s){let o;return a==="desc"?o=s.fields[e]-r.fields[e]:a==="asc"&&(o=r.fields[e]-s.fields[e]),o});else if(i==="string"||i==="Default"){let r=(s,o)=>{let d=s.fields[e].toLowerCase(),m=o.fields[e].toLowerCase(),l;return a==="desc"?l=m.localeCompare(d,"en",{numeric:!0}):a==="asc"&&(l=d.localeCompare(m,"en",{numeric:!0})),l};n.sort(r)}return n};function N(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function T(t){return new DOMParser().parseFromString(t,"text/html").documentElement.textContent}function D(){var a;let t=(a=document.querySelector('[data-element="address"]'))==null?void 0:a.textContent;if(!t)return;let e="/request-for-contract?address="+encodeURIComponent(t)+"&at="+encodeURIComponent(tableName)+"&atv="+encodeURIComponent(tableViewName);window.open(e,"_blank")}var C;(C=document.querySelector("#btn-request-a-contract"))==null||C.addEventListener("click",t=>{t.preventDefault(),D()});var q;(q=document.querySelector("#btn-request-a-contract-m"))==null||q.addEventListener("click",t=>{t.preventDefault(),D()});})();
