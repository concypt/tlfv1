"use strict";(()=>{var x=window.$memberstackDom,y=window.location.href.split("/").pop(),H=y==null?void 0:y.split("?")[0];x.getCurrentMember().then(({data:t})=>{t||b()});var b=()=>{let t=!0,e=document.referrer.split("/").pop(),c=e==null?void 0:e.split("?")[0],i=document.querySelectorAll('[data-element="refferer-item"]');if(!i)return;i.forEach(o=>{var d,u;let n=(d=o.querySelector('[data-element="refferer-name"]'))==null?void 0:d.textContent,l=(u=o.querySelector('[data-element="refferer-listing"]'))==null?void 0:u.textContent;n===c&&l===H&&(t=!1)}),console.log(t);let a=new URLSearchParams(window.location.search),r=Object.fromEntries(a.entries());if(r){let o=document.querySelector('[data-element="contact-agent-name"]');if(!o)return;o.textContent=r.name;let n=document.querySelector('[data-element="contact-agent-phone"]');if(!n)return;n.textContent=r.phone,n.closest("a").href="tel:"+r.phone;let l=document.querySelector('[data-element="contact-agent-email"]');if(!l)return;l.textContent=r.email,l.closest("a").href="mailto:"+r.email;let d=document.querySelector('[data-element="contact-agent-agency"]');if(!d)return;d.textContent=r.agency}t&&(window.location.href="/")};$(()=>{console.log("ready!!!"),x.getCurrentMember().then(({data:t})=>{if(t){console.log(t);let e=t.customFields["first-name"]+" "+t.customFields["last-name"],c=t.customFields.mobile,i=t.auth.email,a=t.customFields["agency-name"],r="?name="+e+"&phone="+c+"&email="+i+"&agency="+a;console.log(r);let o=w(21),n="https://"+window.location.hostname+"/fdiautvtnzxynmp/"+o+"/"+r,l=document.querySelector("#input-url"),d=document.querySelector("#input-share-slug"),u=document.querySelector("#input-listing"),m=document.querySelector('[data-element="fake-text"]');l&&(l.value=n),d&&(d.value=o),u&&y&&(u.value=y),m&&(m.innerHTML=n);let g=document.querySelector("#btn-copy-url");g==null||g.addEventListener("click",function(s){C(n)});let f=document.querySelector('[data-element="btn-fake-share-url"]');f==null||f.addEventListener("click",function(s){C(n)})}})});function k(t){let e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")}catch(c){console.error("Fallback: Oops, unable to copy",c)}document.body.removeChild(e),M('[data-element="copied-notification"]')}function C(t){if(!navigator.clipboard){k(t);return}navigator.clipboard.writeText(t).then(function(){M('[data-element="copied-notification"]')},function(e){console.log(e)})}function M(t){let e=document.querySelector(t);e&&(e.style.display="block"),setTimeout(()=>{e&&(e.style.display="none")},1e3)}function w(t){let e="",c="abcdefghijklmnopqrstuvwxyz0123456789",i=c.length;for(let a=0;a<t;a++)e+=c.charAt(Math.floor(Math.random()*i));return e}async function D(t,e){let c;return t=T(t)||"",console.log(t),e?(e=T(e)||"",console.log(e),c="https://api.airtable.com/v0/appWNf6XfqAR6n0oT/"+encodeURIComponent(t)+"?api_key=keyUxdcC40qxNrt1Y&&view="+encodeURIComponent(e).replace(/%20/g,"+")):c="https://api.airtable.com/v0/appWNf6XfqAR6n0oT/"+encodeURIComponent(t)+"?api_key=keyUxdcC40qxNrt1Y&",console.log(c),await(await fetch(c)).json()}var q;tableName?D(tableName,tableViewName).then(t=>A(t)):((q=document.querySelector('[data-element="sl-table-wrapper"]'))==null||q.remove(),document.querySelector('[data-element="sl-title"]').textContent="Stocklist not found");var A=t=>{var f;if(t.error){(f=document.querySelector('[data-element="sl-table-wrapper"]'))==null||f.remove(),document.querySelector('[data-element="sl-title"]').textContent="Stocklist not found";return}let e=t.records;e.forEach(s=>{s.fields["Unit/Lot"]&&(s.fields["Unit/Lot"]=parseInt(s.fields["Unit/Lot"])),s.fields.Price&&(s.fields.Price="$"+I(s.fields.Price))});let c=e[0].fields,i=Object.keys(c),r=["Unit/Lot","Price","Beds","Baths","Car Park","Internal"].filter(s=>i.indexOf(s)>-1),o=i.filter(s=>r.indexOf(s)===-1);o.push(o.splice(o.indexOf("Status"),1)[0]),o.forEach(s=>{s!=="Discount"&&r.push(s)});let n=document.querySelector('[data-element="table-row"]'),l=n==null?void 0:n.firstChild;n!=null&&n.innerHTML&&(n.innerHTML="");let d="grid-template-columns: ";r.forEach(s=>{let p=l==null?void 0:l.cloneNode(!0);p.textContent=s,p.setAttribute("data-sortelement",s),n==null||n.append(p),d=d+"1fr "}),document.querySelectorAll(".s-table-row-inner").forEach(s=>{s.setAttribute("style",d)});let u=document.querySelector('[data-element="stocklist-row"]');if(!u)return;let m=u==null?void 0:u.parentElement;if(!m)return;L(e,u,m,"Unit/Lot","asc",r),document.querySelectorAll(".s-table-head-item").forEach(s=>{s.addEventListener("click",p=>{var h,S,E;p.preventDefault(),s.classList.contains("selected")||((h=document.querySelector(".selected"))==null||h.classList.remove("asc"),(S=document.querySelector(".selected"))==null||S.classList.remove("desc"),(E=document.querySelector(".selected"))==null||E.classList.remove("selected")),s.classList.contains("desc")&&!s.classList.contains("first")?(L(e,u,m,s.dataset.sortelement,"asc",r),s.classList.add("selected","asc"),s.classList.remove("desc")):(L(e,u,m,s.dataset.sortelement,"desc",r),s.classList.contains("first")||(s.classList.add("selected","desc"),s.classList.remove("asc")))})})},L=(t,e,c,i,a,r)=>{c.innerHTML="";let o=!1,n=P(t,i,a);for(let l in n)if(n.hasOwnProperty(l)){let d=n[l].fields,u=U(e,d,r);if(!u)return;o&&u.classList.add("colored"),o=!o,c.append(u)}},U=(t,e,c)=>{let i=t.cloneNode(!0),a=i.querySelector(".s-table-cell-item"),r=a==null?void 0:a.parentElement;if(r&&a)return r.innerHTML="",i.innerHTML="",c.forEach(o=>{let n=a.cloneNode(!0);n.setAttribute("data-element",o),n.textContent=e[o],(o==="Internal"||o==="Land")&&(n.innerHTML=e[o]+"m <sup>2</sup>"),o==="Status"&&(e[o]==="Sold"?n.classList.add("status-red"):e[o]==="Under Contract"?n.classList.add("status-orange"):e[o]==="Available"&&n.classList.add("status-green")),r.append(n)}),i.append(r),i},P=(t,e,c)=>{if(e==="Default")return t;let i=typeof t[0].fields[e];if(!i)return;let a=t.slice(0);return i==="number"?a.sort(function(r,o){let n;return c==="desc"?n=o.fields[e]-r.fields[e]:c==="asc"&&(n=r.fields[e]-o.fields[e]),n}):(i==="string"||i==="Default")&&a.sort(function(r,o){let n=r.fields[e].toLowerCase(),l=o.fields[e].toLowerCase(),d;return c==="desc"?d=l<n?-1:l>n?1:0:c==="asc"&&(d=n<l?-1:n>l?1:0),d}),a};function I(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function T(t){return new DOMParser().parseFromString(t,"text/html").documentElement.textContent}var v;(v=document.querySelector("#btn-request-a-contract"))==null||v.addEventListener("click",t=>{var i;t.preventDefault();let e=(i=document.querySelector('[data-element="address"]'))==null?void 0:i.textContent;if(!e)return;let c="/request-for-contract?address="+encodeURIComponent(e);window.location.href=c});})();
