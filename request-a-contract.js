"use strict";(()=>{var R=window.$memberstackDom;R.getCurrentMember().then(({data:n})=>{if(n){let e=document.querySelector("#memberstack_id");if(!e)return;e.value=n.id}});var i=document.querySelector('[data-element="Purchaser"]');i==null||i.addEventListener("change",n=>{n.preventDefault();let e=n.target.value,t=document.querySelector('[data-purchaser="Joint"]');e==="Joint"&&(t==null||t.classList.remove("hide")),e==="Single"&&(t==null||t.classList.add("hide"))});var d=document.querySelector('[data-element="Buying Entity Type"]');d==null||d.addEventListener("change",n=>{n.preventDefault();let e=n.target.value,t=document.querySelector('[data-element="Buying Entity Name"]');e!=="Named above"&&(t==null||t.classList.remove("hide")),(e==="Named above"||e==="")&&(t==null||t.classList.add("hide"))});var f=[];document.querySelectorAll('[data-element="listing-item"]').forEach(n=>{var a,o;let e=(a=n.querySelector('[data-element="listing-address"]'))==null?void 0:a.textContent,t=(o=n.querySelector('[data-element="listing-airtable"]'))==null?void 0:o.textContent,s={address:e,airtable:t};s&&f.push(s)});var m=new autoComplete({placeHolder:"Search for listing...",data:{src:f,keys:["address"],cache:!0},resultItem:{highlight:!0},events:{input:{selection:n=>{let e=n.detail.selection.value;m.input.value=e}}}}),x;(x=document.querySelector("#autoComplete"))==null||x.addEventListener("selection",function(n){let e=n.detail;m.input.blur();let t=e.selection.value[e.selection.key];m.input.value=t;let s=e.selection.value.airtable;I(s).then(a=>A(a))});var B=[];document.querySelectorAll('[data-element="agent-item"]').forEach(n=>{var t,s;let e=((t=n.querySelector('[data-element="agent-first-name"]'))==null?void 0:t.textContent)+" "+((s=n.querySelector('[data-element="agent-last-name"]'))==null?void 0:s.textContent);e&&B.push(e)});var N=new autoComplete({selector:"#Purchaser-Agent",placeHolder:"Search for Agents...",data:{src:B,cache:!0},resultItem:{highlight:!0},events:{input:{selection:n=>{let e=n.detail.selection.value;N.input.value=e}}}});async function I(n){let e="https://api.airtable.com/v0/appWNf6XfqAR6n0oT/"+n+"?api_key=keyUxdcC40qxNrt1Y";return await(await fetch(e)).json()}var A=n=>{let e=document.querySelector('[data-element="AvailableUnits"]');if(!e)return;let t=e.options.length-1,s;for(s=t;s>=1;s--)e.remove(s);let a=n.records,o=[];a&&(a.forEach(c=>{let r="Unit "+c.fields["Unit/Lot"]+" - $"+_(c.fields.Price)+" / "+(c.fields.Land?c.fields.Land:"")+(c.fields.Land?"sqm / ":"")+c.fields.Beds+" / "+c.fields.Baths+" / "+c.fields["Car Park"];o.push(r)}),o.sort(F),o.forEach(c=>{let r=document.createElement("option");r.text=c+"",r.value=c+"",e==null||e.add(r)}))},D="a95d779bec144d448ebcafccdec4ce61";function U(){let n=new AddyComplete(document.getElementById("main-address"));n.options.excludePostBox=!1,n.fields={address1:document.getElementById("main-address"),address2:document.getElementById("main-address2"),city:document.getElementById("main-city"),postcode:document.getElementById("main-postcode"),suburb:document.getElementById("main-suburb")}}(function(n,e){let t=n.createElement("script"),s="https://www.addysolutions.com/address-lookup/1.6.2/js/addy.min.js";t.src=s+"?loadcss=true&enableLocation=false&country=nz&nzKey="+D,t.type="text/javascript",t.async=1,t.onload=U,n.body.appendChild(t)})(document,window);var u=(n,e,t)=>{let s=n==null?void 0:n.cloneNode(!0),a=s.querySelector("span"),o=s.querySelector("input");if(!(!a||!o))return a.textContent=e.toString(),o.value=t.toString(),s},E=(n,e,t)=>{let s=e==null?void 0:e.parentElement;e==null||e.remove(),n.forEach((a,o,c)=>{var y,h,g,L,p,S,v,C;let r=a,H="Yes - "+((y=r.querySelector('[data-element="'+t+' Location"]'))==null?void 0:y.textContent)+(t!=="Lawyer"?" ":": ")+((h=r.querySelector('[data-element="'+t+' Name"]'))==null?void 0:h.textContent)+" at "+((g=r.querySelector('[data-element="'+t+' Firm"]'))==null?void 0:g.textContent)+" ("+((L=r.querySelector('[data-element="'+t+' Email"]'))==null?void 0:L.textContent)+" / "+((p=r.querySelector('[data-element="'+t+' Phone"]'))==null?void 0:p.textContent)+") ",M=((S=r.querySelector('[data-element="'+t+' Location"]'))==null?void 0:S.textContent)+": "+((v=r.querySelector('[data-element="'+t+' Name"]'))==null?void 0:v.textContent)+" at "+((C=r.querySelector('[data-element="'+t+' Firm"]'))==null?void 0:C.textContent);if(e){let q=u(e,H,M);if(q&&(s==null||s.append(q)),o===c.length-1){let l;t==="Lawyer"?l=u(e,"No - please fill in purchaser solicitors section below","Custom Lawyer"):l=u(e,"No - please fill in purchaser broker section below","Custom Broker"),l&&(s==null||s.append(l));let w=s==null?void 0:s.querySelector(".w-form-formradioinput:first-child");w&&(w.checked=!0)}}})},J=document.querySelectorAll('[data-element="Lawyer Item"]'),b=document.querySelector('[data-element="Lawyer Radio"]');b&&E(J,b,"Lawyer");var P=document.querySelectorAll('[data-element="Broker Item"]'),k=document.querySelector('[data-element="Broker Radio"]');k&&E(P,k,"Broker");document.addEventListener("click",function(n){var t,s,a,o;let e=n.target;e.classList.contains("lawyer-radio")&&(e.value==="Custom Lawyer"?(t=document.querySelector('[data-element="Custom Lawyer"]'))==null||t.classList.remove("hide"):(s=document.querySelector('[data-element="Custom Lawyer"]'))==null||s.classList.add("hide")),e.classList.contains("broker-radio")&&(e.value==="Custom Broker"?(a=document.querySelector('[data-element="Custom Broker"]'))==null||a.classList.remove("hide"):(o=document.querySelector('[data-element="Custom Broker"]'))==null||o.classList.add("hide"))});function _(n){return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function F(n,e){let t=[],s=[];for(n.replace(/(\d+)|(\D+)/g,function(a,o,c){t.push([o||1/0,c||""])}),e.replace(/(\d+)|(\D+)/g,function(a,o,c){s.push([o||1/0,c||""])});t.length&&s.length;){let a=t.shift(),o=s.shift(),c=a[0]-o[0]||a[1].localeCompare(o[1]);if(c)return c}return t.length-s.length}$(()=>{let e=new Proxy(new URLSearchParams(window.location.search),{get:(a,o)=>a.get(o)}).address,t=document.querySelector('[data-element="Listing"]');t.value=e;let s="";f.forEach(a=>{a.address===e&&(s=a.airtable)}),s&&I(s).then(a=>A(a))});})();
