"use strict";(()=>{var i=document.querySelector('[data-element="Purchaser"]');i==null||i.addEventListener("change",s=>{s.preventDefault();let e=s.target.value,t=document.querySelector('[data-purchaser="Joint"]');e==="Joint"&&(t==null||t.classList.remove("hide")),e==="Single"&&(t==null||t.classList.add("hide"))});var d=document.querySelector('[data-element="Buying Entity Type"]');d==null||d.addEventListener("change",s=>{s.preventDefault();let e=s.target.value,t=document.querySelector('[data-element="Buying Entity Name"]');e!=="Named above"&&(t==null||t.classList.remove("hide")),(e==="Named above"||e==="")&&(t==null||t.classList.add("hide"))});var f=[];document.querySelectorAll('[data-element="listing-item"]').forEach(s=>{var a,o;let e=(a=s.querySelector('[data-element="listing-address"]'))==null?void 0:a.textContent,t=(o=s.querySelector('[data-element="listing-airtable"]'))==null?void 0:o.textContent,n={address:e,airtable:t};n&&f.push(n)});var m=new autoComplete({placeHolder:"Search for listing...",data:{src:f,keys:["address"],cache:!0},resultItem:{highlight:!0},events:{input:{selection:s=>{let e=s.detail.selection.value;m.input.value=e}}}}),k;(k=document.querySelector("#autoComplete"))==null||k.addEventListener("selection",function(s){let e=s.detail;m.input.blur();let t=e.selection.value[e.selection.key];m.input.value=t;let n=e.selection.value.airtable;I(n).then(a=>A(a))});var B=[];document.querySelectorAll('[data-element="agent-item"]').forEach(s=>{var t,n;let e=((t=s.querySelector('[data-element="agent-first-name"]'))==null?void 0:t.textContent)+" "+((n=s.querySelector('[data-element="agent-last-name"]'))==null?void 0:n.textContent);e&&B.push(e)});var M=new autoComplete({selector:"#Purchaser-Agent",placeHolder:"Search for Agents...",data:{src:B,cache:!0},resultItem:{highlight:!0},events:{input:{selection:s=>{let e=s.detail.selection.value;M.input.value=e}}}});async function I(s){let e="https://api.airtable.com/v0/appWNf6XfqAR6n0oT/"+s+"?api_key=keyUxdcC40qxNrt1Y";return await(await fetch(e)).json()}var A=s=>{let e=document.querySelector('[data-element="AvailableUnits"]');if(!e)return;let t=e.options.length-1,n;for(n=t;n>=1;n--)e.remove(n);let a=s.records,o=[];a&&(a.forEach(c=>{let r="Unit "+c.fields["Unit/Lot"]+" - $"+P(c.fields.Price)+" / "+(c.fields.Land?c.fields.Land:"")+(c.fields.Land?"sqm / ":"")+c.fields.Beds+" / "+c.fields.Baths+" / "+c.fields["Car Park"];o.push(r)}),o.sort(F),o.forEach(c=>{let r=document.createElement("option");r.text=c+"",r.value=c+"",e==null||e.add(r)}))},N="a95d779bec144d448ebcafccdec4ce61";function U(){let s=new AddyComplete(document.getElementById("main-address"));s.options.excludePostBox=!1,s.fields={address1:document.getElementById("main-address"),address2:document.getElementById("main-address2"),city:document.getElementById("main-city"),postcode:document.getElementById("main-postcode"),suburb:document.getElementById("main-suburb")}}(function(s,e){let t=s.createElement("script"),n="https://www.addysolutions.com/address-lookup/1.6.2/js/addy.min.js";t.src=n+"?loadcss=true&enableLocation=false&country=nz&nzKey="+N,t.type="text/javascript",t.async=1,t.onload=U,s.body.appendChild(t)})(document,window);var u=(s,e,t)=>{let n=s==null?void 0:s.cloneNode(!0),a=n.querySelector("span"),o=n.querySelector("input");if(!(!a||!o))return a.textContent=e.toString(),o.value=t.toString(),n},E=(s,e,t)=>{let n=e==null?void 0:e.parentElement;e==null||e.remove(),s.forEach((a,o,c)=>{var y,h,g,L,p,S,v,C;let r=a,H="Yes - "+((y=r.querySelector('[data-element="'+t+' Location"]'))==null?void 0:y.textContent)+(t!=="Lawyer"?" ":": ")+((h=r.querySelector('[data-element="'+t+' Name"]'))==null?void 0:h.textContent)+" at "+((g=r.querySelector('[data-element="'+t+' Firm"]'))==null?void 0:g.textContent)+" ("+((L=r.querySelector('[data-element="'+t+' Email"]'))==null?void 0:L.textContent)+" / "+((p=r.querySelector('[data-element="'+t+' Phone"]'))==null?void 0:p.textContent)+") ",R=((S=r.querySelector('[data-element="'+t+' Location"]'))==null?void 0:S.textContent)+": "+((v=r.querySelector('[data-element="'+t+' Name"]'))==null?void 0:v.textContent)+" at "+((C=r.querySelector('[data-element="'+t+' Firm"]'))==null?void 0:C.textContent);if(e){let q=u(e,H,R);if(q&&(n==null||n.append(q)),o===c.length-1){let l;t==="Lawyer"?l=u(e,"No - please fill in purchaser solicitors section below","Custom Lawyer"):l=u(e,"No - please fill in purchaser broker section below","Custom Broker"),l&&(n==null||n.append(l));let w=n==null?void 0:n.querySelector(".w-form-formradioinput:first-child");w&&(w.checked=!0)}}})},D=document.querySelectorAll('[data-element="Lawyer Item"]'),b=document.querySelector('[data-element="Lawyer Radio"]');b&&E(D,b,"Lawyer");var J=document.querySelectorAll('[data-element="Broker Item"]'),x=document.querySelector('[data-element="Broker Radio"]');x&&E(J,x,"Broker");document.addEventListener("click",function(s){var t,n,a,o;let e=s.target;e.classList.contains("lawyer-radio")&&(e.value==="Custom Lawyer"?(t=document.querySelector('[data-element="Custom Lawyer"]'))==null||t.classList.remove("hide"):(n=document.querySelector('[data-element="Custom Lawyer"]'))==null||n.classList.add("hide")),e.classList.contains("broker-radio")&&(e.value==="Custom Broker"?(a=document.querySelector('[data-element="Custom Broker"]'))==null||a.classList.remove("hide"):(o=document.querySelector('[data-element="Custom Broker"]'))==null||o.classList.add("hide"))});function P(s){return s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function F(s,e){let t=[],n=[];for(s.replace(/(\d+)|(\D+)/g,function(a,o,c){t.push([o||1/0,c||""])}),e.replace(/(\d+)|(\D+)/g,function(a,o,c){n.push([o||1/0,c||""])});t.length&&n.length;){let a=t.shift(),o=n.shift(),c=a[0]-o[0]||a[1].localeCompare(o[1]);if(c)return c}return t.length-n.length}$(()=>{let e=new Proxy(new URLSearchParams(window.location.search),{get:(a,o)=>a.get(o)}).address,t=document.querySelector('[data-element="Listing"]');t.value=e;let n="";f.forEach(a=>{a.address===e&&(n=a.airtable)}),n&&I(n).then(a=>A(a))});})();
